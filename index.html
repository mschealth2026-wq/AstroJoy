<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AstroVision AI - Live Transits</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src='https://unpkg.com/tesseract.js@v4.0.1/dist/tesseract.min.js'></script>
    <style>
        body { background: #0f172a; color: white; font-family: 'Inter', sans-serif; }
        .house-card { background: #1e293b; border: 1px solid #334155; position: relative; overflow: hidden; }
        .transit-badge { background: #f59e0b; color: #451a03; font-size: 9px; font-weight: 800; padding: 2px 6px; border-radius: 4px; position: absolute; top: 10px; right: 10px; }
        .planet-row { background: #0f172a; border-radius: 8px; padding: 8px; margin-bottom: 6px; border-left: 3px solid #38bdf8; }
        .tag { font-size: 10px; font-weight: bold; padding: 2px 5px; border-radius: 4px; }
        .tag-friend { background: #065f46; color: #34d399; }
        .tag-enemy { background: #7f1d1d; color: #f87171; }
        .spinner { border: 3px solid rgba(255, 255, 255, 0.1); border-left-color: #38bdf8; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-6xl mx-auto">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-sky-400 mb-2">AstroVision Live</h1>
            <p class="text-slate-400">January 30, 2026 â€¢ Natal Analysis + Live Transits</p>
        </header>

        <div class="bg-slate-800 p-8 rounded-2xl border-2 border-dashed border-slate-600 text-center mb-8">
            <input type="file" id="chartUpload" accept="image/*" class="hidden">
            <label for="chartUpload" class="cursor-pointer bg-sky-600 hover:bg-sky-500 px-8 py-4 rounded-xl font-bold transition inline-block">
                ðŸ“· Upload Birth Table
            </label>
            <div id="loading" class="hidden mt-6 flex flex-col items-center">
                <div class="spinner mb-2"></div>
                <p class="text-sky-400">Syncing Live Planetary Movements...</p>
            </div>
        </div>

        <div id="chartDisplay" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
    </div>

    <script>
        const zodiac = [
            { name: "Aries", lord: "Mars", theme: "Self & Energy" },
            { name: "Taurus", lord: "Venus", theme: "Wealth & Speech" },
            { name: "Gemini", lord: "Mercury", theme: "Skills & Siblings" },
            { name: "Cancer", lord: "Moon", theme: "Home & Emotions" },
            { name: "Leo", lord: "Sun", theme: "Creativity & Children" },
            { name: "Virgo", lord: "Mercury", theme: "Service & Health" },
            { name: "Libra", lord: "Venus", theme: "Partnership & Marriage" },
            { name: "Scorpio", lord: "Mars", theme: "Secrets & Longevity" },
            { name: "Sagittarius", lord: "Jupiter", theme: "Luck & Higher Wisdom" },
            { name: "Capricorn", lord: "Saturn", theme: "Career & Status" },
            { name: "Aquarius", lord: "Saturn", theme: "Gains & Social Network" },
            { name: "Pisces", lord: "Jupiter", theme: "Spirituality & Loss" }
        ];

        // Current transits as of Jan 30, 2026
        const liveTransits = [
            { p: "Sun", sign: "Aquarius", stay: "1 Month" },
            { p: "Moon", sign: "Cancer", stay: "2.5 Days" },
            { p: "Mars", sign: "Capricorn", stay: "1.5 Months" },
            { p: "Jupiter", sign: "Gemini", stay: "1 Year" },
            { p: "Saturn", sign: "Pisces", stay: "2.5 Years" },
            { p: "Venus", sign: "Capricorn", stay: "1 Month" },
            { p: "Mercury", sign: "Capricorn", stay: "3 Weeks" },
            { p: "Rahu", sign: "Aquarius", stay: "1.5 Years" },
            { p: "Ketu", sign: "Leo", stay: "1.5 Years" }
        ];

        document.getElementById('chartUpload').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;
            document.getElementById('loading').style.display = 'flex';
            const { data: { text } } = await Tesseract.recognize(file, 'eng');
            document.getElementById('loading').style.display = 'none';
            parseChart(text.toLowerCase());
        });

        function parseChart(rawText) {
            const text = rawText.replace(/\n/g, " ");
            const lagMatch = text.match(/lag\D*(\w{3})/);
            if (!lagMatch) return alert("Lagna not found.");
            
            const ascSign = zodiac.find(z => z.name.toLowerCase().startsWith(lagMatch[1]));
            const planetsFound = [];
            ["sun", "mon", "mar", "mer", "jup", "ven", "sat", "rah", "ket"].forEach(p => {
                const regex = new RegExp(`${p}\\D*(\\w{3})\\s*(\\d+)`, 'g');
                let
